List<PurposeCode> checkList = 
    IntStream.range(1, datatypeSheet.getLastRowNum()) // Iterate over the rows
    .mapToObj(i -> datatypeSheet.getRow(i))           // Map each index to a row
    .filter(row -> row != null)                       // Filter out null rows
    .filter(row -> {
        Cell cell0 = row.getCell(0);
        Cell cell1 = row.getCell(1);
        return !(cell0 == null || cell0.getStringCellValue().trim().isEmpty()) &&
               !(cell1 == null || cell1.getStringCellValue().trim().isEmpty());
    }) // Filter rows where both columns 0 and 1 are not null and not empty
    .map(row -> {
        PurposeCode checks = new PurposeCode();

        // Set Iso3aCountryCode if column 1 is not null, otherwise set it to "*"
        checks.setIso3aCountryCode(row.getCell(1) != null ? row.getCell(1).getStringCellValue() : "*");

        // Set PurposeCode if column 2 is not null
        if (ValidationUtil.isNotNull(row.getCell(2))) {
            String s = row.getCell(2).getCellTypeEnum() == CellType.STRING
                ? row.getCell(2).getStringCellValue().trim()
                : String.valueOf(row.getCell(2).getNumericCellValue());
            checks.setPurposeCode(s);
        }

        return checks;  // Return the constructed PurposeCode object
    })
    .collect(Collectors.toList()); // Collect the results into a list
